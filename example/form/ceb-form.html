<!DOCTYPE HTML>
<html lang="en" >
    
    <head>
        
        <meta charset="UTF-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <title>ceb-form | ceb custom-element-builder</title>
        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <meta name="description" content="">
        <meta name="generator" content="GitBook 2.5.2">
        
        
        <meta name="HandheldFriendly" content="true"/>
        <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
        <meta name="apple-mobile-web-app-capable" content="yes">
        <meta name="apple-mobile-web-app-status-bar-style" content="black">
        <link rel="apple-touch-icon-precomposed" sizes="152x152" href="../../gitbook/images/apple-touch-icon-precomposed-152.png">
        <link rel="shortcut icon" href="../../gitbook/images/favicon.ico" type="image/x-icon">
        
    <link rel="stylesheet" href="../../gitbook/style.css">
    
        
        <link rel="stylesheet" href="../../gitbook/plugins/gitbook-plugin-prism/prism.css">
        
    
        
        <link rel="stylesheet" href="../../gitbook/plugins/gitbook-plugin-search/search.css">
        
    
        
        <link rel="stylesheet" href="../../gitbook/plugins/gitbook-plugin-fontsettings/website.css">
        
    
    

        
    
    
    <link rel="next" href="../../example/form/ceb-field.html" />
    
    
    <link rel="prev" href="../../example/form/index.html" />
    

        
    </head>
    <body>
        
        
    <div class="book" data-level="4.2.2.1" data-chapter-title="ceb-form" data-filepath="example/form/ceb-form.md" data-basepath="../.." data-revision="Fri Dec 25 2015 17:52:19 GMT+0100 (CET)">
    

<div class="book-summary">
    <nav role="navigation">
        <ul class="summary">
            
            
            
            

            

            
    
        <li class="chapter " data-level="0" data-path="index.html">
            
                
                    <a href="../../index.html">
                
                        <i class="fa fa-check"></i>
                        
                        Readme
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="1" data-path="INSTALL.html">
            
                
                    <a href="../../INSTALL.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>1.</b>
                        
                        Installation
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="2" data-path="doc/integration/index.html">
            
                
                    <a href="../../doc/integration/index.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>2.</b>
                        
                        Integration
                    </a>
            
            
            <ul class="articles">
                
    
        <li class="chapter " data-level="2.1" data-path="doc/integration/polyfills.html">
            
                
                    <a href="../../doc/integration/polyfills.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>2.1.</b>
                        
                        Polyfills
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="2.2" data-path="doc/integration/global.html">
            
                
                    <a href="../../doc/integration/global.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>2.2.</b>
                        
                        As a global variable
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="2.3" data-path="doc/integration/amd.html">
            
                
                    <a href="../../doc/integration/amd.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>2.3.</b>
                        
                        AMD
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="2.4" data-path="doc/integration/systemjs.html">
            
                
                    <a href="../../doc/integration/systemjs.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>2.4.</b>
                        
                        SystemJS
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="2.5" data-path="doc/integration/commonjs.html">
            
                
                    <a href="../../doc/integration/commonjs.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>2.5.</b>
                        
                        CommonJS
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="2.6" data-path="doc/integration/es2015.html">
            
                
                    <a href="../../doc/integration/es2015.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>2.6.</b>
                        
                        ES2015
                    </a>
            
            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="3" data-path="doc/usage/index.html">
            
                
                    <a href="../../doc/usage/index.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>3.</b>
                        
                        Usage
                    </a>
            
            
            <ul class="articles">
                
    
        <li class="chapter " data-level="3.1" data-path="doc/usage/element.html">
            
                
                    <a href="../../doc/usage/element.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>3.1.</b>
                        
                        element()
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="3.2" data-path="doc/usage/property.html">
            
                
                    <a href="../../doc/usage/property.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>3.2.</b>
                        
                        property()
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="3.3" data-path="doc/usage/attribute.html">
            
                
                    <a href="../../doc/usage/attribute.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>3.3.</b>
                        
                        attribute()
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="3.4" data-path="doc/usage/method.html">
            
                
                    <a href="../../doc/usage/method.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>3.4.</b>
                        
                        method()
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="3.5" data-path="doc/usage/delegate.html">
            
                
                    <a href="../../doc/usage/delegate.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>3.5.</b>
                        
                        delegate()
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="3.6" data-path="doc/usage/on.html">
            
                
                    <a href="../../doc/usage/on.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>3.6.</b>
                        
                        on()
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="3.7" data-path="doc/usage/template.html">
            
                
                    <a href="../../doc/usage/template.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>3.7.</b>
                        
                        template()
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="3.8" data-path="doc/usage/internal-stuff.html">
            
                
                    <a href="../../doc/usage/internal-stuff.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>3.8.</b>
                        
                        Internal stuff
                    </a>
            
            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="4" data-path="example/index.html">
            
                
                    <a href="../../example/index.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>4.</b>
                        
                        Example
                    </a>
            
            
            <ul class="articles">
                
    
        <li class="chapter " data-level="4.1" >
            
            <span><b>4.1.</b> Builders</span>
            
            
            <ul class="articles">
                
    
        <li class="chapter " data-level="4.1.1" data-path="example/builders/baconify.html">
            
                
                    <a href="../../example/builders/baconify.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>4.1.1.</b>
                        
                        baconify
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="4.1.2" data-path="example/builders/handlebarify.html">
            
                
                    <a href="../../example/builders/handlebarify.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>4.1.2.</b>
                        
                        handlebarify
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="4.1.3" data-path="example/builders/idomify.html">
            
                
                    <a href="../../example/builders/idomify.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>4.1.3.</b>
                        
                        idomify
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="4.1.4" data-path="example/builders/reduxify.html">
            
                
                    <a href="../../example/builders/reduxify.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>4.1.4.</b>
                        
                        reduxify
                    </a>
            
            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="4.2" >
            
            <span><b>4.2.</b> Elements</span>
            
            
            <ul class="articles">
                
    
        <li class="chapter " data-level="4.2.1" data-path="example/address-selector/index.html">
            
                
                    <a href="../../example/address-selector/index.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>4.2.1.</b>
                        
                        Address selector
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="4.2.2" data-path="example/form/index.html">
            
                
                    <a href="../../example/form/index.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>4.2.2.</b>
                        
                        Form
                    </a>
            
            
            <ul class="articles">
                
    
        <li class="chapter active" data-level="4.2.2.1" data-path="example/form/ceb-form.html">
            
                
                    <a href="../../example/form/ceb-form.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>4.2.2.1.</b>
                        
                        ceb-form
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="4.2.2.2" data-path="example/form/ceb-field.html">
            
                
                    <a href="../../example/form/ceb-field.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>4.2.2.2.</b>
                        
                        ceb-field
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="4.2.2.3" data-path="example/form/ceb-button.html">
            
                
                    <a href="../../example/form/ceb-button.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>4.2.2.3.</b>
                        
                        ceb-button
                    </a>
            
            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="4.2.3" data-path="example/grid/index.html">
            
                
                    <a href="../../example/grid/index.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>4.2.3.</b>
                        
                        Grid
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="4.2.4" data-path="example/list/index.html">
            
                
                    <a href="../../example/list/index.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>4.2.4.</b>
                        
                        List
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="4.2.5" data-path="example/list-plusplus/index.html">
            
                
                    <a href="../../example/list-plusplus/index.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>4.2.5.</b>
                        
                        List++
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="4.2.6" data-path="example/templator/index.html">
            
                
                    <a href="../../example/templator/index.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>4.2.6.</b>
                        
                        Templator
                    </a>
            
            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="4.3" >
            
            <span><b>4.3.</b> Apps</span>
            
            
            <ul class="articles">
                
    
        <li class="chapter " data-level="4.3.1" data-path="example/todo-app/index.html">
            
                
                    <a href="../../example/todo-app/index.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>4.3.1.</b>
                        
                        Todo App
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="4.3.2" data-path="example/weather-app/index.html">
            
                
                    <a href="../../example/weather-app/index.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>4.3.2.</b>
                        
                        Weather App
                    </a>
            
            
        </li>
    

            </ul>
            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="5" data-path="doc/testing/index.html">
            
                
                    <a href="../../doc/testing/index.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>5.</b>
                        
                        Testing
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="6" >
            
                
                    <a target="_blank" href="https:/tmorin.github.io/ceb/api">
                
                        <i class="fa fa-check"></i>
                        
                            <b>6.</b>
                        
                        API
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="7" data-path="CONTRIBUTING.html">
            
                
                    <a href="../../CONTRIBUTING.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>7.</b>
                        
                        Contributing
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="8" data-path="CHANGELOG.html">
            
                
                    <a href="../../CHANGELOG.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>8.</b>
                        
                        Change Log
                    </a>
            
            
        </li>
    


            
            <li class="divider"></li>
            <li>
                <a href="https://www.gitbook.com" target="blank" class="gitbook-link">
                    Published with GitBook
                </a>
            </li>
            
        </ul>
    </nav>
</div>

    <div class="book-body">
        <div class="body-inner">
            <div class="book-header" role="navigation">
    <!-- Actions Left -->
    

    <!-- Title -->
    <h1>
        <i class="fa fa-circle-o-notch fa-spin"></i>
        <a href="../../" >ceb custom-element-builder</a>
    </h1>
</div>

            <div class="page-wrapper" tabindex="-1" role="main">
                <div class="page-inner">
                
                
                    <section class="normal" id="section-">
                    
                        <h1 id="cebform">ceb-form</h1>
<h2 id="from-form-to-cebform">From <code>form</code> to <code>ceb-form</code></h2>
<p>The main custom element of its example is <code>ceb-form</code>.
It&apos;s an extension of te native <a href="https://html.spec.whatwg.org/multipage/forms.html" target="_blank">HTML5 form</a>.
So, to make it alive, it has to be based on the <code>HTMLFormElement</code> prototype and the <code>form</code> tag name.</p>
<pre><code class="lang-javascript"><span class="token keyword">import</span> <span class="token punctuation">{</span>element<span class="token punctuation">}</span> from <span class="token string">&apos;ceb&apos;</span><span class="token punctuation">;</span>

<span class="token keyword">let</span> cebFormBuilder <span class="token operator">=</span>  <span class="token function">element</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">base</span><span class="token punctuation">(</span>Object<span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span>HTMLFormElement<span class="token punctuation">.</span>prototype<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">&apos;form&apos;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> cebFormBuilder<span class="token punctuation">.</span><span class="token function">register</span><span class="token punctuation">(</span><span class="token string">&apos;ceb-form&apos;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre>
<p>The <code>cebFormBuilder</code> is ready to be used and the custom element too.</p>
<pre><code class="lang-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>form</span> <span class="token attr-name">is</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>ceb-form<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token comment" spellcheck="true">&lt;!-- form controls and more --&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>form</span><span class="token punctuation">&gt;</span></span>
</code></pre>
<h2 id="prevent-submission">Prevent submission</h2>
<p><code>ceb-form</code> should be able to prevent the default form submission behavior.
The attribute <code>prevent-submit</code> will handle this.
If <code>false</code> (i.e. no present into the DOM), the default behavior will be preserved, otherwise it will be skipped.</p>
<p>The attribute is defined by the <code>attribute()</code> builder.</p>
<pre><code class="lang-javascript"><span class="token keyword">import</span> <span class="token punctuation">{</span>element<span class="token punctuation">,</span> attribute<span class="token punctuation">}</span> from <span class="token string">&apos;ceb&apos;</span><span class="token punctuation">;</span>

<span class="token comment" spellcheck="true">/* ... */</span>

cebFormBuilder<span class="token punctuation">.</span><span class="token function">builders</span><span class="token punctuation">(</span>
    <span class="token function">attribute</span><span class="token punctuation">(</span><span class="token string">&apos;prevent-submit&apos;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">boolean</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment" spellcheck="true">/* ... */</span>
</code></pre>
<p>The prevention of the default behavior has to be done into a listener of the <code>submit</code> event.
The listener is added by the <code>on()</code> builder.</p>
<pre><code class="lang-javascript"><span class="token keyword">import</span> <span class="token punctuation">{</span>element<span class="token punctuation">,</span> attribute<span class="token punctuation">,</span> on<span class="token punctuation">}</span> from <span class="token string">&apos;ceb&apos;</span><span class="token punctuation">;</span>

<span class="token comment" spellcheck="true">/* ... */</span>

cebFormBuilder<span class="token punctuation">.</span><span class="token function">builders</span><span class="token punctuation">(</span>
    <span class="token function">attribute</span><span class="token punctuation">(</span><span class="token string">&apos;prevent-submit&apos;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">boolean</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token function">on</span><span class="token punctuation">(</span><span class="token string">&apos;submit&apos;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">invoke</span><span class="token punctuation">(</span><span class="token punctuation">(</span>el<span class="token punctuation">,</span> evt<span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token punctuation">{</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>el<span class="token punctuation">.</span>preventSubmit<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            evt<span class="token punctuation">.</span><span class="token function">preventDefault</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment" spellcheck="true">/* ... */</span>
</code></pre>
<p>Create a <code>ceb-form</code> without submit prevention:</p>
<pre><code class="lang-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>form</span> <span class="token attr-name">is</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>ceb-form<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token comment" spellcheck="true">&lt;!-- form controls and more --&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>form</span><span class="token punctuation">&gt;</span></span>
</code></pre>
<p>Create a <code>ceb-form</code> the submit prevention:</p>
<pre><code class="lang-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>form</span> <span class="token attr-name">is</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>ceb-form<span class="token punctuation">&quot;</span></span> <span class="token attr-name">prevent-submit</span><span class="token punctuation">&gt;</span></span>
    <span class="token comment" spellcheck="true">&lt;!-- form controls and more --&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>form</span><span class="token punctuation">&gt;</span></span>
</code></pre>
<h2 id="prevent-native-validation">Prevent native validation</h2>
<p><code>ceb-form</code> will handle the validation of the form controls it-self.
So, the native validation has to be deactivated.</p>
<pre><code class="lang-javascript"><span class="token keyword">import</span> <span class="token punctuation">{</span>element<span class="token punctuation">,</span> attribute<span class="token punctuation">,</span> method<span class="token punctuation">,</span> on<span class="token punctuation">}</span> from <span class="token string">&apos;ceb&apos;</span><span class="token punctuation">;</span>

<span class="token comment" spellcheck="true">/* ... */</span>

cebFormBuilder<span class="token punctuation">.</span><span class="token function">builders</span><span class="token punctuation">(</span>
    <span class="token function">method</span><span class="token punctuation">(</span><span class="token string">&apos;createdCallback&apos;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">invoke</span><span class="token punctuation">(</span>el <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token punctuation">{</span>
        el<span class="token punctuation">.</span><span class="token function">setAttribute</span><span class="token punctuation">(</span><span class="token string">&apos;novalidate&apos;</span><span class="token punctuation">,</span> <span class="token string">&apos;&apos;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment" spellcheck="true">/* ... */</span>
</code></pre>
<p>At runtime the custom element could be like that:</p>
<pre><code class="lang-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>form</span> <span class="token attr-name">is</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>ceb-form<span class="token punctuation">&quot;</span></span> <span class="token attr-name">novalidate</span><span class="token punctuation">&gt;</span></span>
    <span class="token comment" spellcheck="true">&lt;!-- form controls and more --&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>form</span><span class="token punctuation">&gt;</span></span>
</code></pre>
<h2 id="add-validation-concept">Add validation concept</h2>
<p>Being close to the <a href="https://html.spec.whatwg.org/multipage/forms.html" target="_blank">HTML5 form</a>, <code>ceb-form</code> provides two methods:</p>
<ul>
<li><code>checkValidity()</code></li>
<li><code>reportValidity()</code></li>
</ul>
<p>The first one, validates the from and returns a summary object.
The second one, call the first one but emit events according to the summary state.
Moreover, if the form is not valid, the first invalid form control is focused.</p>
<h3 id="add-rules">Add rules</h3>
<p>Validations are processed according to rules.
Builtin rules are exposed by a dedicated module <code>./rules.js</code>.
<code>ceb-form</code> exposes the method <code>addRule()</code> to defined custom rules.
<code>ceb-form</code> exposes handled rules from the property <code>rules</code>.</p>
<pre><code class="lang-javascript"><span class="token keyword">import</span> <span class="token punctuation">{</span>element<span class="token punctuation">,</span> property<span class="token punctuation">,</span> attribute<span class="token punctuation">,</span> method<span class="token punctuation">,</span> on<span class="token punctuation">}</span> from <span class="token string">&apos;ceb&apos;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span>RULES<span class="token punctuation">}</span> from <span class="token string">&apos;./rules.js&apos;</span><span class="token punctuation">;</span>

<span class="token comment" spellcheck="true">/* ... */</span>

cebFormBuilder<span class="token punctuation">.</span><span class="token function">builders</span><span class="token punctuation">(</span>
    <span class="token function">property</span><span class="token punctuation">(</span><span class="token string">&apos;rules&apos;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getter</span><span class="token punctuation">(</span>el <span class="token operator">=</span><span class="token operator">&gt;</span> RULES<span class="token punctuation">.</span><span class="token function">concat</span><span class="token punctuation">(</span>el<span class="token punctuation">.</span>_rules <span class="token operator">||</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token function">method</span><span class="token punctuation">(</span><span class="token string">&apos;addRule&apos;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">invoke</span><span class="token punctuation">(</span><span class="token punctuation">(</span>el<span class="token punctuation">,</span> name<span class="token punctuation">,</span> filter <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token keyword">false</span><span class="token punctuation">,</span> apply <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token keyword">false</span><span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token punctuation">{</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>el<span class="token punctuation">.</span>_rules<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            el<span class="token punctuation">.</span>_rules <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        el<span class="token punctuation">.</span>_rules<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token punctuation">{</span>name<span class="token punctuation">,</span> filter<span class="token punctuation">,</span> apply<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment" spellcheck="true">/* ... */</span>
</code></pre>
<h3 id="check-the-validity-of-a-form-control">Check the validity of a form control</h3>
<p><code>checkValidity()</code> is massively based on <code>checkFormControlValidity</code>.
<code>checkFormControlValidity</code> validates a form control and returns a summary object.</p>
<pre><code class="lang-javascript"><span class="token keyword">import</span> <span class="token punctuation">{</span>element<span class="token punctuation">,</span> property<span class="token punctuation">,</span> attribute<span class="token punctuation">,</span> method<span class="token punctuation">,</span> on<span class="token punctuation">}</span> from <span class="token string">&apos;ceb&apos;</span><span class="token punctuation">;</span>

<span class="token comment" spellcheck="true">/* ... */</span>

cebFormBuilder<span class="token punctuation">.</span><span class="token function">builders</span><span class="token punctuation">(</span>
    <span class="token function">method</span><span class="token punctuation">(</span><span class="token string">&apos;checkFormControlValidity&apos;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">invoke</span><span class="token punctuation">(</span><span class="token punctuation">(</span>el<span class="token punctuation">,</span> control<span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token punctuation">{</span>
        <span class="token keyword">let</span> errors <span class="token operator">=</span> el<span class="token punctuation">.</span>rules
            <span class="token punctuation">.</span><span class="token function">filter</span><span class="token punctuation">(</span>rule <span class="token operator">=</span><span class="token operator">&gt;</span> rule<span class="token punctuation">.</span><span class="token function">filter</span><span class="token punctuation">(</span>control<span class="token punctuation">)</span><span class="token punctuation">)</span>
            <span class="token punctuation">.</span><span class="token function">reduce</span><span class="token punctuation">(</span><span class="token punctuation">(</span>result<span class="token punctuation">,</span> rule<span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token punctuation">{</span>
                result<span class="token punctuation">[</span>rule<span class="token punctuation">.</span>name<span class="token punctuation">]</span> <span class="token operator">=</span> rule<span class="token punctuation">.</span><span class="token function">apply</span><span class="token punctuation">(</span>control<span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token keyword">return</span> result<span class="token punctuation">;</span>
            <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">let</span> controlIsInvalid <span class="token operator">=</span> Object<span class="token punctuation">.</span><span class="token function">keys</span><span class="token punctuation">(</span>errors<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">reduce</span><span class="token punctuation">(</span><span class="token punctuation">(</span>invalid<span class="token punctuation">,</span> key<span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">&gt;</span> invalid <span class="token operator">?</span> invalid <span class="token punctuation">:</span> errors<span class="token punctuation">[</span>key<span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token keyword">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> <span class="token punctuation">{</span>
            element<span class="token punctuation">:</span> control<span class="token punctuation">,</span>
            valid<span class="token punctuation">:</span> <span class="token operator">!</span>controlIsInvalid<span class="token punctuation">,</span>
            invalid<span class="token punctuation">:</span> controlIsInvalid<span class="token punctuation">,</span>
            errors<span class="token punctuation">:</span> errors
        <span class="token punctuation">}</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment" spellcheck="true">/* ... */</span>
</code></pre>
<h3 id="check-the-form-validity">Check the form validity</h3>
<p>The property <code>elementsAsArray</code> is added to the custom element in order to iterate over the form controls. </p>
<pre><code class="lang-javascript"><span class="token keyword">import</span> <span class="token punctuation">{</span>element<span class="token punctuation">,</span> property<span class="token punctuation">,</span> attribute<span class="token punctuation">,</span> method<span class="token punctuation">,</span> on<span class="token punctuation">,</span> toArray<span class="token punctuation">}</span> from <span class="token string">&apos;ceb&apos;</span><span class="token punctuation">;</span>

<span class="token comment" spellcheck="true">/* ... */</span>

cebFormBuilder<span class="token punctuation">.</span><span class="token function">builders</span><span class="token punctuation">(</span>
    <span class="token function">property</span><span class="token punctuation">(</span><span class="token string">&apos;elementsAsArray&apos;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getter</span><span class="token punctuation">(</span>el <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token function">toArray</span><span class="token punctuation">(</span>el<span class="token punctuation">.</span>elements<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token function">method</span><span class="token punctuation">(</span><span class="token string">&apos;checkValidity&apos;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">invoke</span><span class="token punctuation">(</span>el <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token punctuation">{</span>
        <span class="token keyword">let</span> controls <span class="token operator">=</span> el<span class="token punctuation">.</span>elementsAsArray<span class="token punctuation">;</span>
        <span class="token keyword">let</span> controlStates <span class="token operator">=</span> controls<span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span>el<span class="token punctuation">.</span>checkFormControlValidity<span class="token punctuation">,</span> el<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">let</span> formIsValid <span class="token operator">=</span> controlStates<span class="token punctuation">.</span><span class="token function">reduce</span><span class="token punctuation">(</span><span class="token punctuation">(</span>valid<span class="token punctuation">,</span> state<span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">&gt;</span> valid <span class="token operator">&amp;&amp;</span> state<span class="token punctuation">.</span>valid<span class="token punctuation">,</span> <span class="token keyword">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> <span class="token punctuation">{</span>
            form<span class="token punctuation">:</span> el<span class="token punctuation">,</span>
            valid<span class="token punctuation">:</span> formIsValid<span class="token punctuation">,</span>
            invalid<span class="token punctuation">:</span> <span class="token operator">!</span>formIsValid<span class="token punctuation">,</span>
            controls<span class="token punctuation">:</span> controlStates
        <span class="token punctuation">}</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment" spellcheck="true">/* ... */</span>
</code></pre>
<h3 id="report-the-form-validity">Report the form validity</h3>
<p>The reporting is done from custom event having the type <code>valid</code> or <code>invalid</code>.
The UI part will be later handled by the dedicated custom element <code>ceb-field</code>.</p>
<p><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>ceb</span><span class="token punctuation">/&gt;</span></span></code> provides helpers to dispatch event easily.
There, the helper function <code>dispatchCustomEvent()</code> is used.</p>
<pre><code class="lang-javascript"><span class="token keyword">import</span> <span class="token punctuation">{</span>element<span class="token punctuation">,</span> property<span class="token punctuation">,</span> attribute<span class="token punctuation">,</span> method<span class="token punctuation">,</span> on<span class="token punctuation">,</span> toArray<span class="token punctuation">,</span> dispatchCustomEvent<span class="token punctuation">}</span> from <span class="token string">&apos;ceb&apos;</span><span class="token punctuation">;</span>

<span class="token comment" spellcheck="true">/* ... */</span>

cebFormBuilder<span class="token punctuation">.</span><span class="token function">builders</span><span class="token punctuation">(</span>
    <span class="token function">method</span><span class="token punctuation">(</span><span class="token string">&apos;reportValidity&apos;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">invoke</span><span class="token punctuation">(</span>el <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token punctuation">{</span>
        <span class="token keyword">let</span> formState <span class="token operator">=</span> el<span class="token punctuation">.</span><span class="token function">checkValidity</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">let</span> formEventType <span class="token operator">=</span> formState<span class="token punctuation">.</span>valid <span class="token operator">?</span> <span class="token string">&apos;valid&apos;</span> <span class="token punctuation">:</span> <span class="token string">&apos;invalid&apos;</span><span class="token punctuation">;</span>
        <span class="token function">dispatchCustomEvent</span><span class="token punctuation">(</span>el<span class="token punctuation">,</span> formEventType<span class="token punctuation">,</span> <span class="token punctuation">{</span>
            detail<span class="token punctuation">:</span> formState
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        formState<span class="token punctuation">.</span>controls<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span>controlState <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token punctuation">{</span>
            <span class="token keyword">let</span> controlEventType <span class="token operator">=</span> controlState<span class="token punctuation">.</span>valid <span class="token operator">?</span> <span class="token string">&apos;valid&apos;</span> <span class="token punctuation">:</span> <span class="token string">&apos;invalid&apos;</span><span class="token punctuation">;</span>
            <span class="token function">dispatchCustomEvent</span><span class="token punctuation">(</span>controlState<span class="token punctuation">.</span>element<span class="token punctuation">,</span> controlEventType<span class="token punctuation">,</span> <span class="token punctuation">{</span>
                detail<span class="token punctuation">:</span> controlState
            <span class="token punctuation">}</span><span class="token punctuation">)</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">let</span> firstElement <span class="token operator">=</span> el<span class="token punctuation">.</span>elementsAsArray<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>firstElement<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            firstElement<span class="token punctuation">.</span><span class="token function">focus</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">return</span> formState<span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment" spellcheck="true">/* ... */</span>
</code></pre>
<h2 id="validate-on-events">Validate on events</h2>
<p><code>ceb-form</code> should be able to report validity according to events.
For instance, on <code>submit</code> when the form is invalid, the event propagation should be stopped and the validity reported. 
In another hand, when an input emitted <code>change</code>, it should be validated and its validity reported.</p>
<p><code>ceb-form</code> provided two attributes letting the consumer to choose the events to listen.</p>
<ul>
<li><code>validate-on</code></li>
<li><code>validate-control-on</code></li>
</ul>
<p>The events specify using <code>validate-on</code> will force the form validation.
The events specify using <code>validate-control-on</code> will just validate the event&apos;s target.</p>
<p>An helper function has to be defined in order to facilitate the conversion from string to array:</p>
<pre><code class="lang-javascript"><span class="token keyword">import</span> <span class="token punctuation">{</span>element<span class="token punctuation">,</span> property<span class="token punctuation">,</span> attribute<span class="token punctuation">,</span> method<span class="token punctuation">,</span> on<span class="token punctuation">,</span> toArray<span class="token punctuation">,</span> dispatchCustomEvent<span class="token punctuation">}</span> from <span class="token string">&apos;ceb&apos;</span><span class="token punctuation">;</span>

<span class="token comment" spellcheck="true">/* ... */</span>

<span class="token keyword">function</span> <span class="token function">toEventTypes</span><span class="token punctuation">(</span>string<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token punctuation">(</span>string <span class="token operator">||</span> <span class="token string">&apos;&apos;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">split</span><span class="token punctuation">(</span><span class="token string">&apos;,&apos;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span>name <span class="token operator">=</span><span class="token operator">&gt;</span> name<span class="token punctuation">.</span><span class="token function">toLowerCase</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">filter</span><span class="token punctuation">(</span>name <span class="token operator">=</span><span class="token operator">&gt;</span> name<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment" spellcheck="true">/* ... */</span>
</code></pre>
<h3 id="validate-the-form-on-events">Validate the form on events</h3>
<p>The event are added and removed dynamically according to the value of the attribute <code>validate-on</code>.
And accordingly added or removed when the element is attached or detached. </p>
<pre><code class="lang-javascript"><span class="token keyword">import</span> <span class="token punctuation">{</span>element<span class="token punctuation">,</span> property<span class="token punctuation">,</span> attribute<span class="token punctuation">,</span> method<span class="token punctuation">,</span> on<span class="token punctuation">,</span> toArray<span class="token punctuation">,</span> dispatchCustomEvent<span class="token punctuation">}</span> from <span class="token string">&apos;ceb&apos;</span><span class="token punctuation">;</span>

<span class="token comment" spellcheck="true">/* ... */</span>

cebFormBuilder<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">&apos;after:createdCallback&apos;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">invoke</span><span class="token punctuation">(</span>el <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token punctuation">{</span>
    <span class="token comment" spellcheck="true">// keep a reference of the listener</span>
    el<span class="token punctuation">.</span>_validateFormListener <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span>evt<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">let</span> formState <span class="token operator">=</span> el<span class="token punctuation">.</span><span class="token function">reportValidity</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>formState<span class="token punctuation">.</span>invalid<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            evt<span class="token punctuation">.</span><span class="token function">stopPropagation</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
cebFormBuilder<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">&apos;before:attachedCallback&apos;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">invoke</span><span class="token punctuation">(</span>el <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token punctuation">{</span>
    <span class="token comment" spellcheck="true">// add listeners when attached</span>
    <span class="token function">toEventTypes</span><span class="token punctuation">(</span>el<span class="token punctuation">.</span>validateOn<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span>type <span class="token operator">=</span><span class="token operator">&gt;</span> el<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span>type<span class="token punctuation">,</span> el<span class="token punctuation">.</span>_validateFormListener<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
cebFormBuilder<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">&apos;before:detachedCallback&apos;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">invoke</span><span class="token punctuation">(</span>el <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token punctuation">{</span>
    <span class="token comment" spellcheck="true">// remove listeners when attached</span>
    <span class="token function">toEventTypes</span><span class="token punctuation">(</span>el<span class="token punctuation">.</span>validateOn<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span>type <span class="token operator">=</span><span class="token operator">&gt;</span> el<span class="token punctuation">.</span><span class="token function">removeEventListener</span><span class="token punctuation">(</span>type<span class="token punctuation">,</span> el<span class="token punctuation">.</span>_validateFormListener<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
cebFormBuilder<span class="token punctuation">.</span><span class="token function">builders</span><span class="token punctuation">(</span>
    <span class="token comment" spellcheck="true">// dynamically add/remove listeners according to the updated value</span>
    <span class="token function">attribute</span><span class="token punctuation">(</span><span class="token string">&apos;validate-on&apos;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">listen</span><span class="token punctuation">(</span><span class="token punctuation">(</span>el<span class="token punctuation">,</span> oldVal<span class="token punctuation">,</span> newVal<span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token punctuation">{</span>
        <span class="token function">toEventTypes</span><span class="token punctuation">(</span>oldVal<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span>type <span class="token operator">=</span><span class="token operator">&gt;</span> el<span class="token punctuation">.</span><span class="token function">removeEventListener</span><span class="token punctuation">(</span>type<span class="token punctuation">,</span> el<span class="token punctuation">.</span>_validateFormListener<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">toEventTypes</span><span class="token punctuation">(</span>newVal<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span>type <span class="token operator">=</span><span class="token operator">&gt;</span> el<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span>type<span class="token punctuation">,</span> el<span class="token punctuation">.</span>_validateFormListener<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment" spellcheck="true">/* ... */</span>
</code></pre>
<h3 id="validate-controls-on-events">Validate controls on events</h3>
<p>The event are added and removed dynamically according to the value of the attribute <code>validate-control-on</code>.
And accordingly added or removed when the element is attached or detached. </p>
<pre><code class="lang-javascript"><span class="token keyword">import</span> <span class="token punctuation">{</span>element<span class="token punctuation">,</span> property<span class="token punctuation">,</span> attribute<span class="token punctuation">,</span> method<span class="token punctuation">,</span> on<span class="token punctuation">,</span> toArray<span class="token punctuation">,</span> dispatchCustomEvent<span class="token punctuation">}</span> from <span class="token string">&apos;ceb&apos;</span><span class="token punctuation">;</span>

<span class="token comment" spellcheck="true">/* ... */</span>

cebFormBuilder<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">&apos;after:createdCallback&apos;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">invoke</span><span class="token punctuation">(</span>el <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token punctuation">{</span>
    <span class="token comment" spellcheck="true">// keep a reference of the listener</span>
    el<span class="token punctuation">.</span>_validateControlListener <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span>evt<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">let</span> control <span class="token operator">=</span> evt<span class="token punctuation">.</span>target<span class="token punctuation">;</span>
        <span class="token keyword">let</span> controlState <span class="token operator">=</span> el<span class="token punctuation">.</span><span class="token function">checkFormControlValidity</span><span class="token punctuation">(</span>control<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">let</span> controlEventType <span class="token operator">=</span> controlState<span class="token punctuation">.</span>valid <span class="token operator">?</span> <span class="token string">&apos;valid&apos;</span> <span class="token punctuation">:</span> <span class="token string">&apos;invalid&apos;</span><span class="token punctuation">;</span>
        <span class="token function">dispatchCustomEvent</span><span class="token punctuation">(</span>control<span class="token punctuation">,</span> controlEventType<span class="token punctuation">,</span> <span class="token punctuation">{</span>
            detail<span class="token punctuation">:</span> controlState
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
cebFormBuilder<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">&apos;before:attachedCallback&apos;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">invoke</span><span class="token punctuation">(</span>el <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token punctuation">{</span>
    <span class="token comment" spellcheck="true">// add listeners when attached</span>
    <span class="token function">toEventTypes</span><span class="token punctuation">(</span>el<span class="token punctuation">.</span>validateControlOn<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span>type <span class="token operator">=</span><span class="token operator">&gt;</span> el<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span>type<span class="token punctuation">,</span> el<span class="token punctuation">.</span>_validateControlListener<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
cebFormBuilder<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">&apos;before:detachedCallback&apos;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">invoke</span><span class="token punctuation">(</span>el <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token punctuation">{</span>
    <span class="token comment" spellcheck="true">// remove listeners when attached</span>
    <span class="token function">toEventTypes</span><span class="token punctuation">(</span>el<span class="token punctuation">.</span>validateControlOn<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span>type <span class="token operator">=</span><span class="token operator">&gt;</span> el<span class="token punctuation">.</span><span class="token function">removeEventListener</span><span class="token punctuation">(</span>type<span class="token punctuation">,</span> el<span class="token punctuation">.</span>_validateControlListener<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
cebFormBuilder<span class="token punctuation">.</span><span class="token function">builders</span><span class="token punctuation">(</span>
    <span class="token comment" spellcheck="true">// dynamically add/remove listeners according to the updated value</span>
    <span class="token function">attribute</span><span class="token punctuation">(</span><span class="token string">&apos;validate-control-on&apos;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">listen</span><span class="token punctuation">(</span><span class="token punctuation">(</span>el<span class="token punctuation">,</span> oldVal<span class="token punctuation">,</span> newVal<span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token punctuation">{</span>
        <span class="token function">toEventTypes</span><span class="token punctuation">(</span>oldVal<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span>type <span class="token operator">=</span><span class="token operator">&gt;</span> el<span class="token punctuation">.</span><span class="token function">removeEventListener</span><span class="token punctuation">(</span>type<span class="token punctuation">,</span> el<span class="token punctuation">.</span>_validateControlListener<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">toEventTypes</span><span class="token punctuation">(</span>newVal<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span>type <span class="token operator">=</span><span class="token operator">&gt;</span> el<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span>type<span class="token punctuation">,</span> el<span class="token punctuation">.</span>_validateControlListener<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment" spellcheck="true">/* ... */</span>
</code></pre>
<h3 id="reset-validation-state-on-reset">Reset validation state on reset</h3>
<p>On <code>reset</code>, the form should dispatch a <code>valid</code> event.</p>
<pre><code class="lang-javascript"><span class="token keyword">import</span> <span class="token punctuation">{</span>element<span class="token punctuation">,</span> property<span class="token punctuation">,</span> attribute<span class="token punctuation">,</span> method<span class="token punctuation">,</span> on<span class="token punctuation">,</span> toArray<span class="token punctuation">,</span> dispatchCustomEvent<span class="token punctuation">}</span> from <span class="token string">&apos;ceb&apos;</span><span class="token punctuation">;</span>

<span class="token comment" spellcheck="true">/* ... */</span>

cebFormBuilder<span class="token punctuation">.</span><span class="token function">builders</span><span class="token punctuation">(</span>
    <span class="token function">on</span><span class="token punctuation">(</span><span class="token string">&apos;reset&apos;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">invoke</span><span class="token punctuation">(</span>el <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token punctuation">{</span>
        <span class="token keyword">let</span> controlStates <span class="token operator">=</span> el<span class="token punctuation">.</span>elementsAsArray<span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span>control <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token punctuation">(</span><span class="token punctuation">{</span>
            element<span class="token punctuation">:</span> control<span class="token punctuation">,</span>
            valid<span class="token punctuation">:</span> <span class="token keyword">true</span><span class="token punctuation">,</span>
            invalid<span class="token punctuation">:</span> <span class="token keyword">false</span><span class="token punctuation">,</span>
            errors<span class="token punctuation">:</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">let</span> formState <span class="token operator">=</span> <span class="token punctuation">{</span>
            valid<span class="token punctuation">:</span> <span class="token keyword">true</span><span class="token punctuation">,</span>
            invalid<span class="token punctuation">:</span> <span class="token keyword">false</span><span class="token punctuation">,</span>
            controls<span class="token punctuation">:</span> controlStates
        <span class="token punctuation">}</span><span class="token punctuation">;</span>
        <span class="token function">dispatchCustomEvent</span><span class="token punctuation">(</span>el<span class="token punctuation">,</span> <span class="token string">&apos;valid&apos;</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
            detail<span class="token punctuation">:</span> formState
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        controlStates<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span>state <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token function">dispatchCustomEvent</span><span class="token punctuation">(</span>state<span class="token punctuation">.</span>element<span class="token punctuation">,</span> <span class="token string">&apos;valid&apos;</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
            detail<span class="token punctuation">:</span> state
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment" spellcheck="true">/* ... */</span>
</code></pre>

                    
                    </section>
                
                
                </div>
            </div>
        </div>

        
        <a href="../../example/form/index.html" class="navigation navigation-prev " aria-label="Previous page: Form"><i class="fa fa-angle-left"></i></a>
        
        
        <a href="../../example/form/ceb-field.html" class="navigation navigation-next " aria-label="Next page: ceb-field"><i class="fa fa-angle-right"></i></a>
        
    </div>
</div>

        
<script src="../../gitbook/app.js"></script>

    
    <script src="../../gitbook/plugins/gitbook-plugin-github/plugin.js"></script>
    

    
    <script src="../../gitbook/plugins/gitbook-plugin-ga/plugin.js"></script>
    

    
    <script src="../../gitbook/plugins/gitbook-plugin-search/lunr.min.js"></script>
    

    
    <script src="../../gitbook/plugins/gitbook-plugin-search/search.js"></script>
    

    
    <script src="../../gitbook/plugins/gitbook-plugin-sharing/buttons.js"></script>
    

    
    <script src="../../gitbook/plugins/gitbook-plugin-fontsettings/buttons.js"></script>
    

<script>
require(["gitbook"], function(gitbook) {
    var config = {"github":{"url":"https://github.com/tmorin/ceb/"},"ga":{"token":"UA-20179310-5","configuration":{"cookieDomain":"tmorin.github.io"}},"sitemap":{"hostname":"https://tmorin.github.io/ceb/"},"prism":{},"search":{},"sharing":{"facebook":true,"twitter":true,"google":false,"weibo":false,"instapaper":false,"vk":false,"all":["facebook","google","twitter","weibo","instapaper"]},"fontsettings":{"theme":"white","family":"sans","size":2}};
    gitbook.start(config);
});
</script>

        
    </body>
    
</html>
